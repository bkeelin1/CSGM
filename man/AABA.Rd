% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AABA.R
\name{AABA}
\alias{AABA}
\title{AABA - Analysis of Associations Between Attributes}
\usage{
AABA(
  Models,
  point_set = NULL,
  paired_subsets = FALSE,
  cors = TRUE,
  vips = TRUE,
  covs = TRUE,
  regs = TRUE,
  PSLR = FALSE,
  VIP_trim = TRUE,
  key = NULL,
  parallel = TRUE,
  core_choice = "detect",
  print_progress = TRUE,
  ...
)
}
\arguments{
\item{Models}{Nested list object containing regression hypotheses to test. Each list element should
contain Response and Predictor data, structured as:

\itemize{
\item 'Hypothesis Test Models' # Argument Models object name
\itemize{
\item 'Symphyseal shape ~ Posterior Corpus Properties' --- 1st hypothesis model
\itemize{
\item 'Symphyseal shape ~ LM1-M2 Corpus Properties ' --- 1st hypothesis test
\itemize{
\item Symphyseal Landmarks --- Response Data within hypothesis test
\item LM1-M2 Corpus Properties --- Predictor data within hypothesis test
\item dt_parameters --- Optional data transformation parameters
}
\item 'Symphyseal shape ~ LP3-P4 Corpus Properties ' --- 2nd hypothesis test
\itemize{
\item Symphyseal Landmarks --- Response Data within hypothesis test
\item LP3-P4 Corpus Properties --- Predictor data within hypothesis test
\item dt_parameters --- Optional data transformation parameters
}
\item 'Symphyseal shape ~ RP3-P4 Corpus Properties ' --- 3rd hypothesis test
\itemize{
\item Symphyseal Landmarks --- Response Data within hypothesis test
\item RP3-P4 Corpus Properties --- Predictor data within hypothesis test
\item dt_parameters --- Optional data transformation parameters
}
\item 'Symphyseal shape ~ RM1-M2 Corpus Properties ' --- 4th hypothesis test
\itemize{
\item Symphyseal Landmarks --- Response Data within hypothesis test
\item RM1-M2 Corpus Properties --- Predictor data within hypothesis test
\item dt_parameters --- Optional data transformation parameters
}
}
\item 'Symphyseal shape ~ Posterior Corpus Properties' --- 2nd hypothesis model
\itemize{
\item 'Symphyseal shape ~ All Corpus Properties ' --- 1st hypothesis test
\itemize{
\item Symphyseal Landmarks --- Response Data within hypothesis test
\item Posterior Corpus Properties --- Predictor data within hypothesis test
\item dt_parameters --- Optional data transformation parameters
}
}
\item ..... --- 3rd hypothesis model
}
}}

\item{point_set}{Optional nested list specifying variable subsets to analyze. Structure must
match Models argument with added subset definitions:
\itemize{
\item point_set
\itemize{
\item Model_1 # Argument object name
\itemize{
\item Response               # Response list subsets (e.g., landmarks)
\itemize{
\item Subset_1 = c(1:20)    # Landmarks 1-20
\item Subset_2 = c(21:40)   # Landmarks 21-40
\item Subset_3 = c(41:60)   # Landmarks 41-60
}
\item Predictor              # Predictor subsets (e.g., data table)
\itemize{
\item Subset_1 = c(1:5)     # Variables 1-5
\item Subset_2 = c(6:10)    # Variables 6-10
\item Subset_3 = c(11:15)   # Variables 11-15
}
}
}
}}

\item{paired_subsets}{Logical value indicating whether to analyze all possible combinations
of response and predictor subsets}

\item{cors}{Logical value indicating whether to conduct correlation analysis}

\item{vips}{Logical value indicating whether to conduct PLS and variable importance analysis}

\item{covs}{Logical value indicating whether to conduct a shape specific covariation analysis}

\item{regs}{Logical value indicating whether to conduct prediction/classification analysis}

\item{PSLR}{Logical value indicating whether to conduct Procrustes shape linear regression.}

\item{VIP_trim}{Logical value indicating whether to trim regression models by VIP scores calculated in vips. Only applicable when vips = TRUE as well as either regs or PSLR is set to TRUE.}

\item{key}{Optional character string for naming output directories}

\item{parallel}{Logical value indicating whether to use parallel processing}

\item{core_choice}{Character value specifying number of cores to use}

\item{print_progress}{Logical value indicating whether to display progress bars}

\item{...}{Additional arguments passed to underlying functions. Can include:
\itemize{
\item{cor.bio parameters: method}
\item{Bio.VIP parameters: Res_transform, Pred_transform, Res_ncomp, Pred_ncomp}
\item{pred parameters: package, p_calc, n_boot, perm, CV, which_classify}
\item{PSLR parameters: write.results, restructured.results}
}}
}
\value{
A list containing results from all enabled analyses:
\itemize{
\item{Cor.Results}{If cors=TRUE, correlation analysis results:
\itemize{
\item{correlation results}{Correlation matrices}
\item{Mantel/Canonical Correlation statistics}{Matrix correlation tests}
\item{Subset analyses}{If point_set provided}
\item{Correlograms}{In folder directory "AABA Results"}
}
}
\item{VIP.Results}{If vips=TRUE, PLS and variable importance results:
\itemize{
\item{VIP scores}{Variable importance in projection scores}
\item{PLS model statistics}{degrees of freedom, R2, Q2, RMSEP, p-value}
\item{Visualization plots}{VIP score plots}
}
}
\item{Reg.Results}{If regs=TRUE, prediction/classification results:
\itemize{
\item{Model performance}{Accuracy/error metrics}
\item{Predictions}{Predicted values/classes}
\item{Statistical significance}{p-values, regression statistics}
}
}
\item{PSLR.Results}{If PSLR=TRUE and Response contains landmarks:
\itemize{
\item{Shape regression results}{Procrustes regression statistics}
\item{Shape changes}{Predicted shape deformations via \code{lolshape}}
}
}
}
}
\description{
AABA is an umbrella function used to analyze relationships between multivariate
and multidimensional data. This function takes a model-based hypothesis
approach to conduct multiple tests to evaluate one or more hypothesis models
related to integration, correlation, covariation, classification, and/or prediction.
Data can be subsetted and transformed using the \code{DT} function (see details).
AABA has the ability to conduct three subsequent series of analyses: (1)
correlation via \code{cor.bio}, (2) covariation/integration via \code{Bio.VIP},
and (3) multivariate prediction or classification via \code{pred}.
}
\details{
AABA integrates multiple statistical approaches to provide a comprehensive analysis
of relationships between multivariate datasets. The function processes each hypothesis
model sequentially through up to four analytical stages, depending on the enabled options.
Multiple tests of subsetted data for a single test within a hypothesis model
is also supported through the point_set parameter, enabling investigation of
specific variable combinations or anatomical regions. When paired_subsets=TRUE,
all possible combinations of response and predictor subsets are analyzed,
providing a comprehensive view of relationships between data sets.

When cors = TRUE, several correlation and integration statistics will be estimated
to evaluate the associations between multivariate data sets via via \code{cor.bio}.
If the multivariate data sets structures are identical, a permuted Mantel test
is conducted, otherwise canonical correlation analysis is performed. Correlograms
of correlation matrices are generated as an output to visualize variable associations.
See \code{\link{cor.bio}} for more details.

When vips = TRUE, a user specified partial least squares (PLS) and variable importance
in projection (VIP) analysis is performed for each test within each hypothesis model,
This part of the function also generates summary statistics from the PLS analyses
as well as VIP plots to assess variable importance when vip_plots = TRUE.
See \code{\link{Bio.VIP}} for more details.

When covs = TRUE, a shape specific two-block PLS (2B-PLS) covariation analysis
is conducted and subsequently will generate interactive .html files in a user
specified directory to view the major shape changes associated with each latent
variable using the \code{lolshape} function. See \code{\link{Bio.VIP}} for more details.

When regs = TRUE, the function will conduct a permuted, cross-validated, and/or
bootstrapped prediction or classification regression via the \code{pred} function.
This function, like the others, permits for both data subsetting as well offers
different methods to test for statistical significance using a flexible
Randomized Residual Permutation Procedure (RRPP) which has been adapted for
multivariate data. See \code{\link{pred}} for more details.

When PSLR = TRUE, a Procrustes Shape Linear Regression (PSLR) is performed via
the \code{PSLR} function. This function specifically handles landmark data as
response (dependent) data, conducting shape regression analysis while
preserving geometric relationships. See \code{\link{PSLR}} for more details.

Data transformation can be parameterized through dt_parameters within the Models
structure as the third object within a test within a hypothesis model or
through arguments passed via the argument (...). These parameters modify how
data is processed before each analytical stage, allowing flexibility in
handling different data types.
}
\examples{
\dontrun{
# Example 1: Analysis with geometric morphometric data
# Test relationships between mandibular shape and biomechanical properties

# Create model structure
Models <- list(
  'Mandible_Analysis' = list(
    'Symphysis_Biomechanics' = list(
      'Response' = Corpus_Land[241:360,,],  # Symphysis landmarks
      'Predictor' = Biomechanics \%>\%
        filter(Region == "LM1M2") \%>\%
        select(5:93)  # Biomechanical variables
    )
  )
)

# Define variable subsets
point_set <- list(
  'Mandible_Analysis' = list(
    'Symphysis_Biomechanics' = list(
      'Response' = list('Anterior' = 1:60, 'Posterior' = 61:120),
      'Predictor' = list(
        'Dimensions' = c(5:8, 10:15),
        'Cortical_Thickness' = c(4, 16:18, 30:60)
      )
    )
  )
)

# Run complete analysis including shape regression
results_shape <- AABA(
  Models = Models,
  point_set = point_set,
  cors = TRUE,
  vips = TRUE,
  regs = TRUE,
  PSLR = TRUE,  # Include shape regression
  vip_method = "spls",
  parallel = TRUE
)

# Example 2: Analysis with standard multivariate data
# Test relationships between biomechanical properties at different cross-sections

# Create model structure for non-shape analysis
Models_standard <- list(
  'Biomechanics_Analysis' = list(
    'CrossSection_Comparison' = list(
      'Response' = Biomechanics \%>\%
        filter(Region == "LM1M2") \%>\%
        select(5:93),
      'Predictor' = Biomechanics \%>\%
        filter(Region == "LP3P4") \%>\%
        select(5:93)
    )
  )
)

# Run analysis without shape regression
results_standard <- AABA(
  Models = Models_standard,
  cors = TRUE,
  vips = TRUE,
  regs = TRUE,
  PSLR = FALSE,  # Skip shape regression
  vip_method = "spls",
  parallel = TRUE
)
}
}
\references{
Placeholder
}
\seealso{
\code{\link{cor.bio}} \code{\link{Bio.VIP}} \code{\link{pred}} \code{\link{PSLR}}
}
\author{
Brian Anthony Keeling
}
