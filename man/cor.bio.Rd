% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cor.bio.R
\name{cor.bio}
\alias{cor.bio}
\title{Correlation Analysis for sets of Multivariate data}
\usage{
cor.bio(
  Models,
  point_set = NULL,
  paired_subsets = FALSE,
  parallel = TRUE,
  core_choice = "detect",
  ...
)
}
\arguments{
\item{Models}{Nested list object containing regression hypotheses to test. Each list element should
contain Response and Predictor data, structured as:

\itemize{
\item 'Hypothesis Test Models' # Argument Models object name
\itemize{
\item 'Symphyseal shape ~ Posterior Corpus Properties' --- 1st hypothesis model
\itemize{
\item 'Symphyseal shape ~ LM1-M2 Corpus Properties ' --- 1st hypothesis test
\itemize{
\item Symphyseal Landmarks --- Response Data within hypothesis test
\item LM1-M2 Corpus Properties --- Predictor data within hypothesis test
\item dt_parameters --- Optional data transformation parameters
}
\item 'Symphyseal shape ~ LP3-P4 Corpus Properties ' --- 2nd hypothesis test
\itemize{
\item Symphyseal Landmarks --- Response Data within hypothesis test
\item LP3-P4 Corpus Properties --- Predictor data within hypothesis test
\item dt_parameters --- Optional data transformation parameters
}
\item 'Symphyseal shape ~ RP3-P4 Corpus Properties ' --- 3rd hypothesis test
\itemize{
\item Symphyseal Landmarks --- Response Data within hypothesis test
\item RP3-P4 Corpus Properties --- Predictor data within hypothesis test
\item dt_parameters --- Optional data transformation parameters
}
\item 'Symphyseal shape ~ RM1-M2 Corpus Properties ' --- 4th hypothesis test
\itemize{
\item Symphyseal Landmarks --- Response Data within hypothesis test
\item RM1-M2 Corpus Properties --- Predictor data within hypothesis test
\item dt_parameters --- Optional data transformation parameters
}
}
\item 'Symphyseal shape ~ Posterior Corpus Properties' --- 2nd hypothesis model
\itemize{
\item 'Symphyseal shape ~ All Corpus Properties ' --- 1st hypothesis test
\itemize{
\item Symphyseal Landmarks --- Response Data within hypothesis test
\item Posterior Corpus Properties --- Predictor data within hypothesis test
\item dt_parameters --- Optional data transformation parameters
}
}
\item ..... --- 3rd hypothesis model
}
}}

\item{point_set}{Optional nested list specifying variable subsets to analyze. Structure must
match Models argument with added subset definitions:
\itemize{
\item point_set
\itemize{
\item Model_1 # Argument object name
\itemize{
\item Response               # Response list subsets (e.g., landmarks)
\itemize{
\item Subset_1 = c(1:20)    # Landmarks 1-20
\item Subset_2 = c(21:40)   # Landmarks 21-40
\item Subset_3 = c(41:60)   # Landmarks 41-60
}
\item Predictor              # Predictor subsets (e.g., data table)
\itemize{
\item Subset_1 = c(1:5)     # Variables 1-5
\item Subset_2 = c(6:10)    # Variables 6-10
\item Subset_3 = c(11:15)   # Variables 11-15
}
}
}
}}

\item{parallel}{Logical value indicating whether to use parallel processing}

\item{...}{Arguments to pass for the \code{\link{DT}} function.}
}
\value{
A list containing correlation analysis results for each model:
\itemize{
\item{Cor.all.Mantels:   Nested list structure Mantel test results of unsubsetted data including:
\itemize{
\item{r:    Mantel/Canonical correlation statistic}
\item{p:    Statistical significance}
\item{I:    Mean squared correlation (overall correlation strength)}
\item{I_x:    Within-set mean squared correlation for predictor variables}
\item{I_y:    Within-set mean squared correlation for response variables}
}
}
\item{Cor.subset.Mantels:   Nested list structure of Mantel test results of subsetted data including:
\itemize{
\item{r:    Mantel/Canonical correlation statistic}
\item{p:    Statistical significance}
\item{I:    Mean squared correlation (overall correlation strength)}
\item{I_x:    Within-set mean squared correlation for predictor variables}
\item{I_y:    Within-set mean squared correlation for response variables}
}
}
}

A list of class "cor.bio" containing correlation analysis results organized by model:
\itemize{
\item{Cor.all.Mantels:   Mantel test results
\itemize{
\item{r:    Mantel/Canonical correlation statistic}
\item{p:    Statistical significance}
\item{I:    Mean squared correlation (overall correlation strength)}
\item{I_x:    Within-set mean squared correlation for predictor variables}
\item{I_y:    Within-set mean squared correlation for response variables}
}
}
\item{Cor.subset.Mantels:    Optional when point_set is provided
\itemize{
\item{r:    Mantel/Canonical correlation statistic}
\item{p:    Statistical significance}
\item{I:    Mean squared correlation (overall correlation strength)}
\item{I_x:    Within-set mean squared correlation for predictor variables}
\item{I_y:    Within-set mean squared correlation for response variables}
}
}
}
}
\description{
cor.bio is a function designed to investigate, in parallel, relationships between sets
of multivariate data through several permuted correlation tests. This function uses a
model-based hypothesis testing structure where a \code{Models} nested list object
contains hypothesis tests which usually involve one or more correlation test sets
of data. Data can be both subsetted and transformed using the \code{DT} function
(see details). The function calculates correlation coefficients and generates
correlograms to visualize dataset relationships as well as conducts either
Mantel tests (for same data structures) or canonical correlation tests (for
different data structures). This function also output correlation summary statistics
which can be useful for contexts of integration.
}
\details{
cor.bio conducts correlation analyses in parallel for each test within a hypothesis
model using both correlation coefficient matrices. For each test within a
hypothesis model, the function first performs user-specified data transformations
via the \code{DT} function parameters. If no parameters additional DT related
parameters are provided through argument (...), the function proceeds with
the raw data. When geometric morphometric data is supplied in \link{p x k x n}
(landmarks, dimensions, observations) array format, the function automatically
converts the data to a data frame while preserving spatial relationships.

The function implements a two-stage correlation analysis approach. First, it calculates
standard Pearson correlation coefficients between all variables, generating a complete
correlation matrix with associated p-values for significance testing. These correlations
are visualized through correlograms generated using the \pkg{corrplot} package, with
significant correlations (p < 0.05) distinctly marked. Second, the function conducts
either a permuted Mantel test for same structured data or a permuted canonical correlation tests
with 1000 permutations to assess matrix-wide correlations. The function outputs
a correlation statistic (r) and significance value (p), along with overall (I) and
intradata (I_x, I_y) correlation measures.

When point_set is provided, the function performs separate correlation analyses
sequentially for each defined subset. The function automatically performs two separate
tests in subsetted cases: (1) a complete analysis without subsets (Cor.All.Mantels),
(2) a series of paired subset analysis (Cor.subset.Mantels). Additionally,
the joint data correlation matrices are also output by the function for the
same subset comparison (same.subsets) and a trimmed matrix of variables where r >= 0.7
(trim.same.subsets) as well as a paired subset comparison matrix (pair.subsets)
and a trimmed matrix of variables where r >= 0.7 (trim.dif.subsets).

The function generates several output files stored in an organized directory structure.
Correlograms are automatically saved as high-resolution PNG files, named according
to the model and test structure. For subset analyses, separate plots are generated
for each subset or subset combination. Statistical results are stored in the returned
list object, organized hierarchically to match the input model structure.

For geometric morphometric data, cor.bio first transforms the data. If no data
transformation is selected, the data will be transformed as a \link{n x p} matrix and
subject to principal component analysis. This ensures that shape information is
appropriately considered in the correlation calculations. All other data types
will first be subject to a user-specified data transformation using the \code{DT}
function parameters via the argument (...) or as the third object of each hypothesis
model test in the Models argument. If no \code{DT} function parameters are
provided, no data transformation will occur prior to correlation analysis.
The function automatically detects landmark data based on array dimensionality
and adjusts its procedures accordingly.
}
\examples{
\dontrun{

# Test for correlations between mandibular symphysis shape and cross-sectional properties
# at different cross-sections

# Create model structure
Models <- list(
  'Symphyseal_Shape ~ Posterior_Corpus_Biomechanics' = list(
    'Symphysis_LM1M2' = list(
      'Response' = Corpus_Land[241:360,,],  # Symphysis landmarks
      'Predictor' = Biomechanics \%>\%
        filter(Region == "LM1M2") \%>\%
        select(5:93)  # Biomechanical variables
    ),
    'Symphysis_LP3P4' = list(
      'Response' = Corpus_Land[241:360,,],
      'Predictor' = Biomechanics \%>\%
        filter(Region == "LP3P4") \%>\%
        select(5:93)
    ),
    'Symphysis_RP3P4' = list(
      'Response' = Corpus_Land[241:360,,],
      'Predictor' = Biomechanics \%>\%
        filter(Region == "RP3P4") \%>\%
        select(5:93)
    ),
    'Symphysis_LP3P4' = list(
      'Response' = Corpus_Land[241:360,,],
      'Predictor' = Biomechanics \%>\%
        filter(Region == "RM1M2") \%>\%
        select(5:93)
    ),
  )
)

# Define variable subsets for testing which cross-sectional properties are important in symphyseal shape
point_set <- list('Symphyseal Shape ~ Posterior Corpus Properties' =
                     list(
                       'Symphysis_Shape ~ LM1M2' = list(
                         'Symphysis_Shape' = list(
                              'Subset_1' = c(1:120), # symphysis has 120 total landmarks
                              'Subset_2' = c(1:120),
                              'Subset_3' = c(1:120),
                              'Subset_4' = c(1:120),
                              'Subset_5' = c(1:120)
                              ),

                         'LM1M2' = list(
                              'Dimensions' = c(5,7:12,14:19),
                              'Orientation' = c(13, 28),
                              'Cortical Thickness' = c(6, 20:22, 34:93),
                              'Bending Resistance' = c(23:27),
                              'Breaking Strength' = c(29:33)
                              )
                         ),
                       'Symphysis_Shape ~ LP3P4' = list(
                         'Symphysis_Shape' = list(
                              'Subset_1' = c(1:120), # symphysis has 120 total landmarks
                              'Subset_2' = c(1:120),
                              'Subset_3' = c(1:120),
                              'Subset_4' = c(1:120),
                              'Subset_5' = c(1:120)
                              ),

                         'LP3P4' = list(
                              'Dimensions' = c(5,7:12,14:19),
                              'Orientation' = c(13, 28),
                              'Cortical Thickness' = c(6, 20:22, 34:93),
                              'Bending Resistance' = c(23:27),
                              'Breaking Strength' = c(29:33)
                              )
                         ),
                        'Symphysis_Shape ~ RP3P4' = list(
                         'Symphysis_Shape' = list(
                              'Subset_1' = c(1:120), # symphysis has 120 total landmarks
                              'Subset_2' = c(1:120),
                              'Subset_3' = c(1:120),
                              'Subset_4' = c(1:120),
                              'Subset_5' = c(1:120)
                              ),

                         'RP3P4' = list(
                              'Dimensions' = c(5,7:12,14:19),
                              'Orientation' = c(13, 28),
                              'Cortical Thickness' = c(6, 20:22, 34:93),
                              'Bending Resistance' = c(23:27),
                              'Breaking Strength' = c(29:33)
                              )
                         ),
                        'Symphysis_Shape ~ RM1M2' = list(
                         'Symphysis_Shape' = list(
                              'Subset_1' = c(1:120), # symphysis has 120 total landmarks
                              'Subset_2' = c(1:120),
                              'Subset_3' = c(1:120),
                              'Subset_4' = c(1:120),
                              'Subset_5' = c(1:120)
                              ),

                         'RM1M2' = list(
                              'Dimensions' = c(5,7:12,14:19),
                              'Orientation' = c(13, 28),
                              'Cortical Thickness' = c(6, 20:22, 34:93),
                              'Bending Resistance' = c(23:27),
                              'Breaking Strength' = c(29:33)
                              )
                         )
                      )
                  )

# Run correlation analysis
results <- cor.bio(
  Models = Models, # add in hypothesis models
  point_set = point_set, # add in subsets
  paired_subsets = FALSE # since the Response data stays the same, its unnecessary to do cross comparisons
) # keep defaults

# Examine results
# View the trimmed correlation matrix based off of the highest correlations
print(results$Symphysis_Correlations$Symphysis_LM1M2$Trim.subset)

# Check the overall Mantel test results
print(results$Symphysis_Correlations$Symphysis_LM1M2$Cor.all.Mantels)

# Check the first subset test (Corpus Dimensions) results for 'Symphysis_Shape ~ LM1M2'
print(results[[1]][[1]][[1]])

# Reading the result structure
# results     This is the output
# [[1]]       This is the first hypothesis model 'Symphyseal Shape ~ Posterior Corpus Properties'
# [[1]]       This is the first test in the first hypothesis model 'Symphysis_Shape ~ LM1M2'
# [[1]]       (Optional if point_set is provided) First subset test for Symphysis_Shape ~ LM1M2'

# Check the second subset test (Corpus Orientation) results now
print(results[[1]][[1]][[2]])

# Check the first subset test (Corpus dimensions) results for 'Symphysis_Shape ~ RM1M2'
print(results[[1]][[4]][[1]])
}
}
\references{
Wei, T., & Simko, V. (2021). R package 'corrplot': Visualization of a Correlation
Matrix (Version 0.92).

Adams, D. C., & Otárola‐Castillo, E. (2013). geomorph: an R package for the
collection and analysis of geometric morphometric shape data. Methods in Ecology
and Evolution, 4(4), 393-399.
}
\seealso{
\code{\link{AABA}} \code{\link{Bio.VIP}} \code{\link{DT}}
}
\author{
Brian Anthony Keeling
}
