% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{plsr_stats}
\alias{plsr_stats}
\title{Calculate Summary Statistics from Partial Least Squares Models}
\usage{
plsr_stats(
  plsr.results,
  ncomp,
  vip,
  vip_method = "spls",
  cv_type = "CV",
  repeats = 25,
  folds = 5,
  tuned = NULL,
  parallel.me = TRUE,
  permut = 500
)
}
\arguments{
\item{plsr.results}{A PLS model object from either mixOmics::spls(), plsdepot::plsreg2(),
or pls::mvr()}

\item{ncomp}{Integer specifying number of components to evaluate}

\item{repeats}{Integer specifying number of cross-validation repetitions}

\item{folds}{Integer specifying number of cross-validation folds}

\item{tuned}{Optional tuning parameters for sparse PLS models}

\item{parallel.me}{Logical value indicating whether to use parallel processing for
cross-validation}

\item{permut}{Integer specifying number of permutations for significance testing}

\item{CV_type}{Character string specifying type of cross-validation:
\itemize{
\item{"CV"}{k-fold cross-validation with multiple repeats}
\item{"LOO"}{Leave-one-out cross-validation}
}}
}
\value{
A data frame containing model performance statistics:
\itemize{
\item{X_var}{Explained variance in predictor variables}
\item{R2}{Model fit statistic (squared correlation coefficient)}
\item{Q2}{Cross-validated R2, indicates predictive ability}
\item{RMSEP}{Root mean square error of prediction}
\item{p_value_RMSE}{Statistical significance based on RMSEP permutation}
\item{p_value_Q2}{Statistical significance based on Q2 permutation}
}
}
\description{
A function designed to compute comprehensive performance statistics from partial least
squares (PLS) model objects through cross-validation procedures. This function serves
as an internal model assessment tool within Bio.VIP, calculating various measures of
fit and predictive ability including R2, Q2, and RMSEP. It handles different PLS model
types (spls, plsr2, mvr) and implements permutation testing for statistical significance.
}
\details{
The plsr_stats function provides a unified approach to assessing PLS model performance
across different PLS implementations. For each model type, it computes both model fit
and predictive ability statistics through cross-validation procedures.

The function first determines the PLS model type (spls, plsr2, or mvr) and adapts its
calculations accordingly. For sparse PLS (spls), it uses the mixOmics framework for
cross-validation. For plsr2 and mvr models, it implements custom cross-validation
procedures.

Cross-validation is performed using either k-fold or leave-one-out methods. For k-fold
cross-validation, multiple repeats are performed to ensure stable estimates. During
cross-validation, the function:
\enumerate{
\item Splits data into training and test sets
\item Fits PLS model on training data
\item Predicts test set responses
\item Calculates performance metrics
}

The function calculates several key statistics:
\itemize{
\item R2: Measures model fit as proportion of variance explained
\item Q2: Cross-validated R2, indicates predictive ability
\item RMSEP: Measures prediction error in original response units
}

Statistical significance is assessed through permutation testing. The function:
\enumerate{
\item Randomly permutes response values
\item Recalculates performance metrics
\item Compares observed statistics to null distribution
\item Calculates p-values
}

The function implements adaptive convergence checking for permutation tests to optimize
computational efficiency while maintaining statistical rigor.
}
\examples{
\dontrun{
# Example: Calculate performance statistics for PLS analysis of symphyseal shape
# and biomechanical properties

# Prepare data
Response <- Corpus_Land[241:360,,]  # Symphysis landmarks
Predictor <- Biomechanics \%>\%
  filter(Region == "LM1M2") \%>\%
  select(5:93)  # Biomechanical variables

# Fit sparse PLS model
library(mixOmics)
spls_model <- spls(Predictor, Response, ncomp = 5)

# Calculate performance statistics
stats <- plsr_stats(
  plsr.results = spls_model,
  ncomp = 5,
  CV_type = "CV",
  repeats = 20,
  folds = 5,
  parallel.me = TRUE,
  permut = 500
)

# View results
print(stats)
}
}
\references{
Rohart F, et al. (2017). "mixOmics: An R package for 'omics feature selection and multiple
data integration." PLoS Computational Biology, 13(11), e1005752.

Wold, S., et al. (2001). PLS-regression: a basic tool of chemometrics. Chemometrics
and Intelligent Laboratory Systems, 58(2), 109-130.
}
\seealso{
\code{\link{Bio.VIP}} \code{\link{NComp}}
}
\author{
Keeling et al., 2025
}
\keyword{internal}
